---
title: Felsöka SMB-eller Dual-Protocol-volymer för Azure NetApp Files | Microsoft Docs
description: Beskriver fel meddelanden och lösningar som kan hjälpa dig att felsöka SMB-eller Dual-Protocol-problem för Azure NetApp Files.
services: azure-netapp-files
documentationcenter: ''
author: b-juche
manager: ''
editor: ''
ms.assetid: ''
ms.service: azure-netapp-files
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: troubleshooting
ms.date: 02/19/2021
ms.author: b-juche
ms.openlocfilehash: ee2d77bf5e1d4af9b78345d55dee8050b84622e9
ms.sourcegitcommit: ac035293291c3d2962cee270b33fca3628432fac
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 03/24/2021
ms.locfileid: "104955541"
---
# <a name="troubleshoot-smb-or-dual-protocol-volumes"></a>Felsöka SMB-eller Dual-Protocol-volymer

Den här artikeln beskriver lösningar på fel villkor som du kan ha när du skapar eller hanterar dubbla protokoll volymer.

## <a name="errors-for-dual-protocol-volumes"></a>Fel för volymer med dubbla protokoll

|     Fel tillstånd    |     Lösningar    |
|-|-|
| LDAP över TLS har Aktiver ATS och det går inte att skapa dubbla protokoll med felet `This Active Directory has no Server root CA Certificate` .    |     Om det här felet uppstår när du skapar en dual-Protocol-volym kontrollerar du att rot certifikat utfärdarens certifikat har laddats upp i ditt NetApp-konto.    |
| Det gick inte att skapa dubbla protokoll med felet `Failed to validate LDAP configuration, try again after correcting LDAP configuration` .    |  Det kan hända att ingen pekare (PTR) av AD host-datorn saknas på DNS-servern. Du måste skapa en zon för omvänd sökning på DNS-servern och sedan lägga till en PTR-post för AD host-datorn i den zonen för omvänd sökning. <br> Anta till exempel att du använder AD-datorns IP-adress `10.x.x.x` , värd namnet för AD-datorn (som hittas med hjälp av `hostname` kommandot) `AD1` och domän namnet är `contoso.com` .  PTR-posten som läggs till i zonen för omvänd sökning ska vara `10.x.x.x`  ->  `contoso.com` .   |
| Det gick inte att skapa dubbla protokoll med felet `Failed to create the Active Directory machine account \\\"TESTAD-C8DD\\\". Reason: Kerberos Error: Pre-authentication information was invalid Details: Error: Machine account creation procedure failed\\n [ 434] Loaded the preliminary configuration.\\n [ 537] Successfully connected to ip 10.x.x.x, port 88 using TCP\\n**[ 950] FAILURE` . |     Det här felet anger att AD-lösenordet är fel när Active Directory är ansluten till NetApp-kontot. Uppdatera AD-anslutningen med rätt lösen ord och försök igen. |
| Det gick inte att skapa dubbla protokoll med felet `Could not query DNS server. Verify that the network configuration is correct and that DNS servers are available` . |   Det här felet anger att DNS inte kan kontaktas. Orsaken kan vara att DNS-IP är felaktigt eller att det finns ett nätverks problem. Kontrol lera DNS-IP-adressen som angetts i AD-anslutning och kontrol lera att IP-adressen är korrekt. <br> Kontrol lera också att AD och volymen finns i samma region och i samma VNet. Om de finns i olika virtuella nätverk kontrollerar du att VNet-peering har upprättats mellan de två virtuella nätverk.|
| Behörigheten nekas vid montering av en dual-Protocol-volym. | En dual-Protocol-volym stöder både NFS-och SMB-protokollen.  När du försöker komma åt den monterade volymen på UNIX-systemet försöker systemet mappa den UNIX-användare som du använder till en Windows-användare. Om ingen mappning hittas inträffar felet "behörighet nekad". <br> Den här situationen gäller även när du använder rot användaren för åtkomst. <br> För att undvika problemet "behörighet nekad" kontrollerar du att Windows Active Directory innehåller `pcuser` innan du ansluter till monterings punkten. Om du lägger till `pcuser` efter att du har påträffat problemet "behörighet nekad" väntar du 24 timmar på att cacheposten rensas innan du försöker igen. |

## <a name="common-errors-for-smb-and-dual-protocol-volumes"></a>Vanliga fel för SMB-och Dual-Protocol-volymer

|     Fel tillstånd    |     Lösningar    |
|-|-|
| Det gick inte att skapa SMB-eller Dual-Protocol-volymen med följande fel: <br> `{"code":"DeploymentFailed","message":"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/DeployOperations for usage details.","details":[{"code":"InternalServerError", "message":"Error when creating - Could not query DNS server. Verify that the network configuration is correct and that DNS servers are available."}]}` | Det här felet anger att DNS inte kan kontaktas. <br> Överväg följande lösningar: <ul><li>Kontrol lera om tillägg och volymen distribueras i samma region.</li> <li>Kontrol lera om tillägg och volymen använder samma VNet. Om de använder olika virtuella nätverk kontrollerar du att virtuella nätverk är peer-kopplade med varandra. Se [rikt linjer för Azure NetApp Files nätverks planering](azure-netapp-files-network-topologies.md). </li> <li>DNS-servern kan ha nätverks säkerhets grupper (NSG: er) tillämpade.  Det tillåter inte att trafiken flödar. I det här fallet öppnar du NSG: er till DNS eller AD för att ansluta till olika portar. Port krav finns i [krav för Active Directory anslutningar](create-active-directory-connections.md#requirements-for-active-directory-connections). </li></ul> <br>Samma lösningar gäller för Azure-tillägg. Azure-tillägg bör distribueras i samma region. Det virtuella nätverket ska finnas i samma region eller peer-kopplas med det VNet som används av volymen. | 
| Det gick inte att skapa SMB-eller Dual-Protocol-volymen med följande fel: <br> `{"code":"DeploymentFailed","message":"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/DeployOperations for usage details.","details":[{"code":"InternalServerError", "message":"Error when creating - Failed to create the Active Directory machine account \"SMBTESTAD-C1C8\". Reason: Kerberos Error: Invalid credentials were given Details: Error: Machine account creation procedure failed\n [ 563] Loaded the preliminary configuration.\n**[ 670] FAILURE: Could not authenticate as 'test@contoso.com':\n** Unknown user (KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN)\n. "}]}`  |  <ul><li>Kontrol lera att det angivna användar namnet är korrekt. </li> <li>Se till att användaren är en del av administratörs gruppen som har behörighet att skapa dator konton. </li> <li> Om du använder Azure lägger du till, se till att användaren är en del av Azure AD-gruppen `Azure AD DC Administrators` . </li></ul> | 
| Det gick inte att skapa SMB-eller Dual-Protocol-volymen med följande fel: <br> `{"code":"DeploymentFailed","message":"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/DeployOperations for usage details.","details":[{"code":"InternalServerError", "message":"Error when creating - Failed to create the Active Directory machine account \"SMBTESTAD-A452\". Reason: Kerberos Error: Pre-authentication information was invalid Details: Error: Machine account creation procedure failed\n [ 567] Loaded the preliminary configuration.\n [ 671] Successfully connected to ip 10.x.x.x, port 88 using TCP\n**[ 1099] FAILURE: Could not authenticate as\n** 'user@contoso.com': CIFS server account password does\n** not match password stored in Active Directory\n** (KRB5KDC_ERR_PREAUTH_FAILED)\n. "}]}` | Kontrol lera att lösen ordet som angavs för anslutning till AD-anslutningen är korrekt. |
| Det gick inte att skapa SMB-eller Dual-Protocol-volymen med följande fel: <br> `{"code":"DeploymentFailed","message":"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/DeployOperations for usage details.","details":[{"code":"InternalServerError","message":"Error when creating - Failed to create the Active Directory machine account \"SMBTESTAD-D9A2\". Reason: SecD Error: ou not found Details: Error: Machine account creation procedure failed\n [ 561] Loaded the preliminary configuration.\n [ 665] Successfully connected to ip 10.x.x.x, port 88 using TCP\n [ 1039] Successfully connected to ip 10.x.x.x, port 389 using TCP\n**[ 1147] FAILURE: Specifed OU 'OU=AADDC Com' does not exist in\n** contoso.com\n. "}]}` | Kontrol lera att den OU-sökväg som angavs för anslutning till AD-anslutningen är korrekt. Om du använder Azure lägger du till att kontrol lera att sökvägen till organisationsenheten är `OU=AADDC Computers` . |
| Det gick inte att skapa SMB-eller Dual-Protocol-volymen med följande fel: <br> `Failed to create the Active Directory machine account \"SMB-ANF-VOL. Reason: LDAP Error: Local error occurred Details: Error: Machine account creation procedure failed. [nnn] Loaded the preliminary configuration. [nnn] Successfully connected to ip 10.x.x.x, port 88 using TCP [nnn] Successfully connected to ip 10.x.x.x, port 389 using [nnn] Entry for host-address: 10.x.x.x not found in the current source: FILES. Ignoring and trying next available source [nnn] Source: DNS unavailable. Entry for host-address:10.x.x.x found in any of the available sources\n*[nnn] FAILURE: Unable to SASL bind to LDAP server using GSSAPI: local error [nnn] Additional info: SASL(-1): generic failure: GSSAPI Error: Unspecified GSS failure. Minor code may provide more information (Cannot determine realm for numeric host address) [nnn] Unable to connect to LDAP (Active Directory) service on contoso.com (Error: Local error) [nnn] Unable to make a connection (LDAP (Active Directory):contosa.com, result: 7643. `  | Det kan hända att ingen pekare (PTR) av AD host-datorn saknas på DNS-servern. Du måste skapa en zon för omvänd sökning på DNS-servern och sedan lägga till en PTR-post för AD host-datorn i den zonen för omvänd sökning. <br> Anta till exempel att du använder AD-datorns IP-adress `10.x.x.x` , värd namnet för AD-datorn (som hittas med hjälp av `hostname` kommandot) `AD1` och domän namnet är `contoso.com` .  PTR-posten som läggs till i zonen för omvänd sökning ska vara `10.x.x.x`  ->  `contoso.com` .   | 
| Det gick inte att skapa SMB-eller Dual-Protocol-volymen med följande fel: <br> `Failed to create the Active Directory machine account \"SMB-ANF-VOL\". Reason: Kerberos Error: KDC has no support for encryption type Details: Error: Machine account creation procedure failed [nnn]Loaded the preliminary configuration. [nnn]Successfully connected to ip 10.x.x.x, port 88 using TCP [nnn]FAILURE: Could not authenticate as 'contosa.com': KDC has no support for encryption type  (KRB5KDC_ERR_ETYPE_NOSUPP) ` | Kontrol lera att [AES-kryptering](/azure/azure-netapp-files/create-active-directory-connections#create-an-active-directory-connection) är aktiverat både i Active Directory-anslutningen och för tjänst kontot. |
| Det gick inte att skapa SMB-eller Dual-Protocol-volymen med följande fel: <br> `Failed to create the Active Directory machine account \"SMB-NTAP-VOL\". Reason: LDAP Error: Strong authentication is required Details: Error: Machine account creation procedure failed\n [ 338] Loaded the preliminary configuration.\n [ nnn] Successfully connected to ip 10.x.x.x, port 88 using TCP\n [ nnn ] Successfully connected to ip 10.x.x.x, port 389 using TCP\n [ 765] Unable to connect to LDAP (Active Directory) service on\n dc51.area51.com (Error: Strong(er) authentication\n required)\n*[ nnn] FAILURE: Unable to make a connection (LDAP (Active\n* Directory):contoso.com), result: 7609\n. "` | Alternativet för LDAP-signering är inte markerat, men AD-klienten har LDAP-signering.  [Aktivera LDAP-signering](create-active-directory-connections.md#create-an-active-directory-connection) och försök igen. | 

## <a name="next-steps"></a>Nästa steg  

* [Skapa en SMB-volym](azure-netapp-files-create-volumes-smb.md)
* [Skapa en volym med dubbla protokoll](create-volumes-dual-protocol.md)
* [Konfigurera en NFS-klient för Azure NetApp Files](configure-nfs-clients.md)
