---
title: Använda Azure Digital Twins-API:er och -SDK:er
titleSuffix: Azure Digital Twins
description: 'Se hur du arbetar med Azure Digitals dubbla API: er, inklusive via SDK.'
author: baanders
ms.author: baanders
ms.date: 06/04/2020
ms.topic: how-to
ms.service: digital-twins
ms.openlocfilehash: f4f3fc8c928cd284088cc51120f1a7b485b4fac0
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 03/30/2021
ms.locfileid: "104595353"
---
# <a name="use-the-azure-digital-twins-apis-and-sdks"></a>Använda Azure Digital Twins-API:er och -SDK:er

Azure Digitals dubbla är utrustade med både **kontroll Plans-API: er** och **data Plans-API: er** för att hantera din instans och dess element. 
* API: erna för kontroll plan är [Azure Resource Manager (arm)](../azure-resource-manager/management/overview.md) API: er, och de kan hantera resurs hanterings åtgärder som att skapa och ta bort din instans. 
* Data Plans-API: erna är Azure Digitals dubbla API: er och används för data hanterings åtgärder som att hantera modeller, dubbla och diagrammet.

Den här artikeln ger en översikt över de API: er som är tillgängliga och metoderna för att interagera med dem. Du kan antingen använda REST-API: er direkt med deras associerade swaggers (via ett verktyg som [Postman](how-to-use-postman.md)) eller via en SDK.

## <a name="overview-control-plane-apis"></a>Översikt: kontroll Plans-API: er

API: er för kontroll plan är [arm](../azure-resource-manager/management/overview.md) -API: er som används för att hantera din Azure Digital-instansen som helhet, så att de täcker åtgärder som att skapa eller ta bort hela instansen. Du kan också använda dessa för att skapa och ta bort slut punkter.

Den mest aktuella API-versionen för kontroll planet är _**2020-12-01**_.

Använda API: er för kontroll plan:
* Du kan anropa API: erna direkt genom att referera till den senaste Swagger-mappen i [kontroll planet Swagger lagrings platsen](https://github.com/Azure/azure-rest-api-specs/tree/master/specification/digitaltwins/resource-manager/Microsoft.DigitalTwins/stable). Den här mappen innehåller också en mapp med exempel som visar användningen.
* Du kan för närvarande komma åt SDK: er för kontroll-API: er i...
  - [**.Net (C#)**](https://www.nuget.org/packages/Microsoft.Azure.Management.DigitalTwins/) ([referens [autogenerated]](/dotnet/api/overview/azure/digitaltwins/management)) ([källa](https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/digitaltwins/Microsoft.Azure.Management.DigitalTwins))
  - [**Java**](https://search.maven.org/search?q=a:azure-mgmt-digitaltwins) ([referens [automatiskt genererad]](/java/api/overview/azure/digitaltwins)) ([källa](https://github.com/Azure/azure-sdk-for-java/tree/master/sdk/digitaltwins))
  - [**Java Script**](https://www.npmjs.com/package/@azure/arm-digitaltwins) ([källa](https://github.com/Azure/azure-sdk-for-js/tree/master/sdk/digitaltwins/arm-digitaltwins))
  - [**Python**](https://pypi.org/project/azure-mgmt-digitaltwins/) ([källa](https://github.com/Azure/azure-sdk-for-python/tree/release/v3/sdk/digitaltwins/azure-mgmt-digitaltwins))
  - [**Go**](https://pkg.go.dev/github.com/Azure/azure-sdk-for-go/services/digitaltwins/mgmt) ([källa](https://github.com/Azure/azure-sdk-for-go/tree/master/services/digitaltwins/mgmt))

Du kan också öva på att kontrol lera plan-API: er genom att interagera med Azure Digitals sammanflätar via [Azure Portal](https://portal.azure.com) och [CLI](how-to-use-cli.md).

## <a name="overview-data-plane-apis"></a>Översikt: data Plans-API: er

Data Plans-API: erna är Azure Digitals dubbla API: er som används för att hantera elementen i Azure Digitals-instansen. De innehåller åtgärder som att skapa vägar, överföra modeller, skapa relationer och hantera dubbla. De kan delas i stor mängd i följande kategorier:
* **DigitalTwinModels** – DigitalTwinModels-kategorin innehåller API: er för att hantera [modeller](concepts-models.md) i en digital Azure-instans. Hanterings aktiviteter omfattar uppladdning, validering, hämtning och borttagning av modeller som skapats i DTDL.
* **DigitalTwins** – DigitalTwins-kategorin innehåller de API: er som utvecklare kan använda för att skapa, ändra och ta bort [digitala dubbla](concepts-twins-graph.md) och deras relationer i en digital Azure-instans.
* **Fråga** – kategorin fråga gör det möjligt [för utvecklare att hitta uppsättningar digitala delar i det dubbla diagrammet](how-to-query-graph.md) mellan relationer.
* **Händelse vägar** – kategorin händelse vägar innehåller API: er för att [dirigera data](concepts-route-events.md)genom systemet och till underordnade tjänster.

Den mest aktuella data planet API-versionen är _**2020-10-31**_.

Använda data Plans-API: er:
* Du kan anropa API: erna direkt, efter...
   - referera till den senaste Swagger-mappen i [data planet Swagger lagrings platsen](https://github.com/Azure/azure-rest-api-specs/tree/master/specification/digitaltwins/data-plane/Microsoft.DigitalTwins). Den här mappen innehåller också en mapp med exempel som visar användningen. 
   - Visa [API Reference-dokumentationen](/rest/api/azure-digitaltwins/).
* Du kan använda **.net (C#) SDK**. För att använda .NET SDK...
   - Du kan visa och lägga till paketet från NuGet: [Azure. DigitalTwins. Core](https://www.nuget.org/packages/Azure.DigitalTwins.Core). 
   - Du kan visa [SDK Reference-dokumentationen](/dotnet/api/overview/azure/digitaltwins/client).
   - Du kan hitta SDK-källan, inklusive en mapp med exempel, i GitHub: [Azure IoT Digitals klient bibliotek för .net](https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/digitaltwins/Azure.DigitalTwins.Core). 
   - Du kan se detaljerade informations-och användnings exempel genom att gå vidare till avsnittet [*.net (C#) SDK (data plan)*](#net-c-sdk-data-plane) i den här artikeln.
* Du kan använda **Java SDK**. För att använda Java SDK...
   - Du kan visa och installera paketet från maven: [`com.azure:azure-digitaltwins-core`](https://search.maven.org/artifact/com.azure/azure-digitaltwins-core/1.0.0/jar)
   - Du kan visa [SDK Reference-dokumentationen](/java/api/overview/azure/digitaltwins/client)
   - Du kan hitta SDK-källan i GitHub: [Azure IoT Digitals klient bibliotek för Java](https://github.com/Azure/azure-sdk-for-java/tree/master/sdk/digitaltwins/azure-digitaltwins-core)
* Du kan använda **Java Script SDK**. För att använda JavaScript SDK...
   - Du kan visa och installera paketet från NPM: [Azure Azure Digitals sammanflätade kärn klient bibliotek för Java Script](https://www.npmjs.com/package/@azure/digital-twins-core).
   - Du kan visa [SDK Reference-dokumentationen](/javascript/api/@azure/digital-twins-core/).
   - du hittar SDK-källan i GitHub: [Azure Azures digitala dubbla klient bibliotek för Java Script](https://github.com/Azure/azure-sdk-for-js/tree/master/sdk/digitaltwins/digital-twins-core)
* Du kan använda **python SDK**. Använda python SDK...
   - Du kan visa och installera paketet från PyPi: [Azure Azure Digitals sammanflätade kärn klient bibliotek för python](https://pypi.org/project/azure-digitaltwins-core/).
   - Du kan visa [SDK Reference-dokumentationen](/python/api/azure-digitaltwins-core/azure.digitaltwins.core).
   - du hittar SDK-källan i GitHub: [Azure Azure Digitals sammanflätade kärn klient bibliotek för python](https://github.com/Azure/azure-sdk-for-python/tree/master/sdk/digitaltwins/azure-digitaltwins-core)
* Du kan skapa ett SDK för ett annat språk med hjälp av AutoRest. Följ instruktionerna i [*instruktion: skapa anpassade SDK: er för Azure Digitals med AutoRest*](how-to-create-custom-sdks.md).

Du kan också utföra API: er för datum plan genom att interagera med Azure Digitals flätar via [CLI](how-to-use-cli.md).

## <a name="net-c-sdk-data-plane"></a>.NET (C#) SDK (data plan)

Azure Digitals .NET (C#) SDK är en del av Azure SDK för .NET. Det är öppen källkod och baseras på Azures digitala dubbla data Plans-API: er.

> [!NOTE]
> Mer information om SDK-design finns i allmänna [design principer för Azure SDK](https://azure.github.io/azure-sdk/general_introduction.html) : er och de aktuella [.net-design rikt linjerna](https://azure.github.io/azure-sdk/dotnet_introduction.html).

Om du vill använda SDK inkluderar du NuGet-paketet **Azure. DigitalTwins. Core** med ditt projekt. Du kommer också att behöva den senaste versionen av **Azure. Identity** -paketet. I Visual Studio kan du lägga till dessa paket med NuGet Package Manager (nås via *verktyg > NuGet package manager > hantera NuGet-paket för lösningen*). Du kan också använda kommando rads verktyget .NET med de kommandon som finns i NuGet-paket länkarna nedan för att lägga till dem i projektet:
* [**Azure. DigitalTwins. Core**](https://www.nuget.org/packages/Azure.DigitalTwins.Core). Det här är paketet för [Azure Digitals dubbla SDK för .net](/dotnet/api/overview/azure/digitaltwins/client). 
* [**Azure. Identity**](https://www.nuget.org/packages/Azure.Identity). Det här biblioteket innehåller verktyg som hjälper dig med autentisering mot Azure.

En detaljerad genom gång av hur du använder API: erna i praktiken finns i [*självstudien: kod a klient program*](tutorial-code.md). 

### <a name="net-sdk-usage-examples"></a>Användnings exempel för .NET SDK

Här följer några kod exempel som illustrerar användningen av .NET SDK.

Autentisera mot tjänsten:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/authentication.cs" id="DefaultAzureCredential_basic":::

[!INCLUDE [Azure Digital Twins: local credentials note](../../includes/digital-twins-local-credentials-note.md)] 

Ladda upp en modell:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/model_operations.cs" id="CreateModel":::

List modeller:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/model_operations.cs" id="GetModels":::

Skapa dubbla:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/twin_operations_sample.cs" id="CreateTwin_withHelper":::

Fråga om dubbla steg och loopar genom resultat:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/queries.cs" id="FullQuerySample":::

Se [*självstudien: koda en klient app*](tutorial-code.md) för en genom gång av den här exempel koden. 

Du kan också hitta ytterligare exempel i [GitHub-lagrings platsen för .net (C#) SDK](https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/digitaltwins/Azure.DigitalTwins.Core/samples).

#### <a name="serialization-helpers"></a>Hjälp program för serialisering

Hjälp för serialisering är hjälp funktioner som är tillgängliga i SDK för att snabbt skapa eller avserialisera dubbla data för åtkomst till grundläggande information. Eftersom Core SDK-metoderna returnerar dubbla data som JSON som standard, kan det vara bra att använda dessa hjälp klasser för att dela upp de dubbla data nedåt.

Tillgängliga hjälp klasser är:
* `BasicDigitalTwin`: Allmänt representerar huvud data för en digital, dubbel
* `BasicDigitalTwinComponent`: Allmänt representerar en komponent i `Contents` egenskaperna för en `BasicDigitalTwin`
* `BasicRelationship`: Allmänt representerar en Relations kärn data
* `DigitalTwinsJsonPropertyName`: Innehåller sträng konstanterna som används vid JSON-serialisering och deserialisering för anpassade digitala dubbla typer

##### <a name="deserialize-a-digital-twin"></a>Deserialisera en digital, dubbel

Du kan alltid deserialisera dubbla data med valfritt JSON-bibliotek, till exempel `System.Text.Json` eller `Newtonsoft.Json` . För grundläggande åtkomst till en enhet kan hjälp klasserna göra detta bekvämare.

`BasicDigitalTwin`Klassen Helper ger dig också åtkomst till egenskaper som definierats i den dubbla, via a `Dictionary<string, object>` . Om du vill visa egenskaperna för den dubbla kan du använda:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/twin_operations_sample.cs" id="GetTwin":::

> [!NOTE]
> `BasicDigitalTwin` använder `System.Text.Json` attribut. Om du vill använda `BasicDigitalTwin` med din [DigitalTwinsClient](/dotnet/api/azure.digitaltwins.core.digitaltwinsclient?view=azure-dotnet&preserve-view=true)måste du antingen initiera klienten med Standardkonstruktören eller, om du vill anpassa alternativet serialisera, använda [JsonObjectSerializer](/dotnet/api/azure.core.serialization.jsonobjectserializer?view=azure-dotnet&preserve-view=true).

##### <a name="create-a-digital-twin"></a>Skapa en digital, dubbel

Med hjälp av `BasicDigitalTwin` klassen kan du förbereda data för att skapa en dubbel instans:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/twin_operations_sample.cs" id="CreateTwin_withHelper":::

Koden ovan motsvarar följande "Manuell" variant:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/twin_operations_other.cs" id="CreateTwin_noHelper":::

##### <a name="deserialize-a-relationship"></a>Deserialisera en relation

Du kan alltid deserialisera Relations data till valfri typ. Använd typen för grundläggande åtkomst till en relation `BasicRelationship` .

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/graph_operations_sample.cs" id="GetRelationshipsCall":::

`BasicRelationship`Hjälp klassen ger också åtkomst till egenskaper som definierats i relationen, via en `IDictionary<string, object>` . Om du vill visa egenskaper kan du använda:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/graph_operations_other.cs" id="ListRelationshipProperties":::

##### <a name="create-a-relationship"></a>Skapa en relation

Med hjälp av `BasicRelationship` klassen kan du också förbereda data för att skapa relationer på en delad instans:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/graph_operations_other.cs" id="CreateRelationship_short":::

##### <a name="create-a-patch-for-twin-update"></a>Skapa en korrigering för dubbel uppdatering

Uppdatera anrop för dubbla och relationer Använd [JSON-patch](http://jsonpatch.com/) -struktur. Om du vill skapa listor över JSON-korrigeringsfiler kan du använda dem `JsonPatchDocument` som visas nedan.

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/twin_operations_other.cs" id="UpdateTwin":::

## <a name="general-apisdk-usage-notes"></a>Allmän information om API/SDK-användning

> [!NOTE]
> Observera att Azure Digital-dubbla är för närvarande inte stöder **CORS (Cross-Origin resurs delning)**. Mer information om påverkan och lösnings strategier finns i avsnittet om [*resurs delning mellan ursprung (CORS)*](concepts-security.md#cross-origin-resource-sharing-cors) i *begrepp: säkerhet för Azure Digitals dubbla lösningar*.

Följande lista innehåller ytterligare information och allmänna rikt linjer för att använda API: er och SDK: er.

* Du kan använda ett HTTP REST-test-verktyg som Postman för att göra direkta anrop till Azures digitala dubbla API: er. Mer information om den här processen finns i [*How-to: göra förfrågningar med Postman*](how-to-use-postman.md).
* Om du vill använda SDK instansierar du `DigitalTwinsClient` klassen. Konstruktorn kräver autentiseringsuppgifter som kan erhållas med en rad autentiseringsmetoder i `Azure.Identity` paketet. Mer `Azure.Identity` information finns i dokumentationen för [namn området](/dotnet/api/azure.identity). 
* Du kan `InteractiveBrowserCredential` komma igång med att komma igång, men det finns flera andra alternativ, inklusive autentiseringsuppgifter för [hanterad identitet](/dotnet/api/azure.identity.interactivebrowsercredential), som du kommer att använda för att autentisera [Azure Functions som är inställda med MSI](../app-service/overview-managed-identity.md?tabs=dotnet) mot digitala Azure-dubbla. Mer information `InteractiveBrowserCredential` finns i [klass dokumentationen](/dotnet/api/azure.identity.interactivebrowsercredential).
* Alla API-anrop visas som medlems funktioner i `DigitalTwinsClient` klassen.
* Alla tjänst funktioner finns i synkrona och asynkrona versioner.
* Alla tjänst funktioner genererar ett undantag för retur status på 400 eller senare. Se till att du omsluter anrop till ett `try` avsnitt och fånga minst `RequestFailedExceptions` . Mer information om den här typen av undantag finns [här](/dotnet/api/azure.requestfailedexception).
* De flesta service metoder returnerar `Response<T>` eller ( `Task<Response<T>>` för asynkrona anrop), där `T` är klassen för returnerat objekt för tjänst anropet. [`Response`](/dotnet/api/azure.response-1)Klassen kapslar in tjänsten Return och visar retur värden i sitt `Value` fält.  
* Tjänst metoder med växlade resultat returnerar `Pageable<T>` eller `AsyncPageable<T>` som resultat. Mer information om `Pageable<T>` klassen finns [här](/dotnet/api/azure.pageable-1). mer information `AsyncPageable<T>` finns [här](/dotnet/api/azure.asyncpageable-1).
* Du kan iterera över växlade resultat med en `await foreach` loop. Mer information om den här processen finns [här](/archive/msdn-magazine/2019/november/csharp-iterating-with-async-enumerables-in-csharp-8).
* Den underliggande SDK: n är `Azure.Core` . I [dokumentationen för Azure namespace](/dotnet/api/azure) finns information om SDK-infrastruktur och-typer.

Tjänst metoder returnerar starkt skrivna objekt när det är möjligt. Men eftersom Azure Digital-dubbla är baserade på modeller som anpassas av användaren vid körning (via DTDL-modeller som har överförts till tjänsten), tar många tjänst-API: er att ta och returnera dubbla data i JSON-format.

## <a name="monitor-api-metrics"></a>Övervaka API-mått

API-mått som förfrågningar, svars tid och felgrader kan visas i [Azure Portal](https://portal.azure.com/). 

Från portalens start sida söker du efter din Azure Digital-instansen för att hämta information. Välj alternativet **mått** från Azure Digitals instansen meny för att öppna sidan *mått* .

:::image type="content" source="media/troubleshoot-metrics/azure-digital-twins-metrics.png" alt-text="Skärm bild som visar mått sidan för Azure Digitals dubbla":::

Härifrån kan du visa måtten för din instans och skapa anpassade vyer.

## <a name="next-steps"></a>Nästa steg

Se hur du gör direkta begär anden till API: erna med Postman:
* [*Anvisningar: göra förfrågningar med Postman*](how-to-use-postman.md)

Eller öva dig på att använda .NET SDK genom att skapa en klient-app med den här självstudien:
* [*Självstudie: koda en klient app*](tutorial-code.md)